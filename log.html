<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QA Assist · Event Log</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .controls {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
        }

        .controls input[type="text"] {
            flex: 1;
            min-width: 220px;
        }

        .controls button {
            padding: 10px 16px;
        }

        .call-summary {
            display: grid;
            gap: 16px;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }

        .summary-card {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 16px;
            display: grid;
            gap: 8px;
        }

        .summary-card h3 {
            margin: 0;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--muted);
        }

        .summary-card .value {
            font-size: 16px;
            font-weight: 600;
        }

        .form-group {
            display: grid;
            gap: 10px;
        }

        .form-group label {
            font-size: 12px;
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .form-group textarea {
            min-height: 120px;
        }

        .error-text {
            color: var(--danger);
            font-size: 12px;
        }

        .hidden {
            display: none !important;
        }

        .result-box {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 16px;
            display: grid;
            gap: 12px;
        }

        .result-box textarea {
            width: 100%;
            min-height: 140px;
            resize: vertical;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(9, 13, 22, 0.85);
            color: var(--text);
            padding: 12px;
            font-size: 13px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .modal-content h2 {
            margin: 0;
            font-size: 20px;
        }

        .modal-content .subtitle {
            margin: 0 0 8px;
            color: var(--muted);
            font-size: 14px;
        }

        .modal-content .tag {
            justify-content: flex-start;
            width: fit-content;
        }

        .modal-content button {
            min-width: 120px;
        }

        #bookmarkComment {
            min-height: 140px;
            resize: vertical;
            background: rgba(9, 13, 22, 0.85);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: var(--text);
            padding: 12px;
        }

        #bookmarkActions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
    </style>
</head>
<body class="full-height">
    <div class="app-shell">
        <aside class="sidebar">
            <div class="brand">
                <img src="icon.png" alt="QA Assist icon" width="32" height="32">
                <span>QA Assist</span>
            </div>
            <nav class="nav-links">
                <a class="nav-link active" href="log.html">Event Log</a>
                <a class="nav-link" href="settings.html">Settings</a>
                <a class="nav-link" href="site-overrides.html">Site Overrides</a>
                <a class="nav-link" href="site-info.html">Site Info</a>
            </nav>
        </aside>
        <main class="main-content">
            <div class="header-block">
                <div>
                    <h1>Event log</h1>
                    <p>Review captured events, manage bookmarks, and prepare call-ready validation notes.</p>
                </div>
            </div>

            <section class="card table-card" id="bookmarkSection">
                <div class="card-header">
                    <h2>Bookmarks</h2>
                    <span id="bookmarkCount" class="badge subtle">0 items</span>
                </div>
                <p class="helper-text">Bookmarked clips stay pinned for quick follow up and call prep.</p>
                <table>
                    <thead>
                        <tr>
                            <th>Event</th>
                            <th>Validation</th>
                            <th>Timestamp</th>
                            <th>Site</th>
                            <th>Notes</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody id="bookmarkBody"></tbody>
                </table>
            </section>

            <section class="card table-card">
                <div class="card-header">
                    <h2>Recent events</h2>
                    <span id="eventCount" class="badge subtle">0 items</span>
                </div>
                <div class="controls">
                    <input type="text" id="filterInput" placeholder="Search by event, validation, truck, timestamp, site, or URL...">
                    <button id="exportCSV" class="secondary">Export CSV</button>
                    <button id="clearLogs" class="ghost">Clear Logs</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Event</th>
                            <th>Validation</th>
                            <th>Timestamp</th>
                            <th>Site</th>
                            <th>Truck</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="logTableBody"></tbody>
                </table>
            </section>
        </main>
    </div>

    <div class="modal" id="callModal" aria-hidden="true">
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="callModalTitle">
            <button class="close-modal" id="closeCallModal" title="Close">×</button>
            <h2 id="callModalTitle">Call validation</h2>
            <p class="subtitle">Confirm the validation type and outcome before copying into the tracker.</p>
            <div class="call-summary">
                <div class="summary-card" id="callSummaryLeft"></div>
                <div class="summary-card" id="callSummaryRight"></div>
            </div>
            <div class="form-group" id="validationPrompt">
                <label>Is this the correct validation type?</label>
                <div class="actions">
                    <button type="button" id="validationYes" class="primary">Yes</button>
                    <button type="button" id="validationNo" class="ghost">No</button>
                </div>
                <div class="tag" id="validationDisplay"></div>
                <div class="form-group hidden" id="validationEditGroup">
                    <label for="validationInput">Adjust validation</label>
                    <input type="text" id="validationInput" placeholder="Enter validation type">
                    <div class="actions">
                        <button type="button" id="saveValidation" class="primary">Save</button>
                        <button type="button" id="cancelValidationEdit" class="ghost">Cancel</button>
                    </div>
                </div>
                <div class="error-text hidden" id="validationError">Please confirm or adjust the validation type.</div>
            </div>
            <div class="form-group">
                <label for="modalMonitorName">Monitor name</label>
                <input type="text" id="modalMonitorName" placeholder="Enter monitor name">
                <div class="error-text hidden" id="monitorError">Please provide a monitor name.</div>
            </div>
            <div class="form-group">
                <label>Was the contact made?</label>
                <div class="actions">
                    <button type="button" id="contactYes" class="primary">Yes</button>
                    <button type="button" id="contactNo" class="ghost">No</button>
                </div>
                <div class="error-text hidden" id="contactError">Select the outcome of the call.</div>
            </div>
            <div class="result-box hidden" id="callResultBox">
                <textarea id="tabOutput" readonly></textarea>
                <div class="actions">
                    <button id="copyEventTime" type="button" class="secondary">Only Copy Event Time</button>
                    <button id="copyCallTime" type="button" class="secondary">Only Copy Call Time</button>
                </div>
                <button id="copyTabOutput" class="primary" type="button">Copy to clipboard</button>
            </div>
            <div class="modal-footer">
                <button type="button" class="ghost" id="cancelCall">Cancel</button>
                <button type="button" class="primary" id="saveCall">Save call</button>
            </div>
        </div>
    </div>

    <div class="modal" id="bookmarkModal" aria-hidden="true">
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="bookmarkTitle">
            <button class="close-modal" id="closeBookmarkModal" title="Close">×</button>
            <h2 id="bookmarkTitle">Bookmark event</h2>
            <p class="subtitle">Add an optional note to highlight next actions for this clip.</p>
            <textarea id="bookmarkComment" placeholder="Add a quick note (optional)"></textarea>
            <div id="bookmarkActions">
                <button type="button" id="bookmarkCancel" class="ghost">Cancel</button>
                <button type="button" id="bookmarkRemove" class="danger hidden">Remove Bookmark</button>
                <button type="button" id="bookmarkSave" class="primary">Add Bookmark</button>
            </div>
        </div>
    </div>

    <div class="modal" id="confirmModal" aria-hidden="true">
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
            <button class="close-modal" id="closeConfirmModal" title="Close">×</button>
            <h2 id="confirmTitle">Confirm action</h2>
            <p class="subtitle" id="confirmMessage">Are you sure?</p>
            <div class="modal-actions">
                <button type="button" id="confirmCancel" class="ghost">Cancel</button>
                <button type="button" id="confirmAccept" class="primary">Confirm</button>
            </div>
        </div>
    </div>

    <div class="toast" id="logToast" role="status" aria-live="polite"></div>

    <script src="log.js"></script>
</body>
</html>
